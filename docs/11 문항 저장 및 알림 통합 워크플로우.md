문항 저장과 알림 프로세스를 포함한 완성된 워크플로우를 설명해 드리겠습니다:

# 문항 저장 및 알림 통합 워크플로우

## 최종 단계: 문항 저장 및 알림

### 1. 결정 에이전트 → 저장 프로세스

-   최종 승인된 문항 세트가 준비되면, 결정 에이전트가 문항 저장 API 호출
-   API 요청 형태:
    ```
    POST /item-repository/save
    {
      "item_set_id": "SET-20250225-IL-003",
      "title": "중학교 2학년 일차함수 평가 문항 세트",
      "items": [
        {
          "item_id": "ITEM-001",
          "content": "일차함수 y = -3x + 5의 그래프를 그리시오.",
          "answer": "...",
          "explanation": "...",
          "difficulty": 0.65,
          "tags": ["일차함수", "그래프", "중2"]
        },
        // 나머지 문항들...
      ],
      "metadata": {
        "target_concept": "일차함수",
        "grade_level": "중학교 2학년",
        "creation_timestamp": "2025-02-25T15:45:30Z",
        "creator_agents": ["planning", "generation", "validation", "decision"],
        "external_sources_used": true
      }
    }
    ```

### 2. 저장 결과 처리

-   저장 API 응답 수신 및 검증
-   저장 성공 시 문항 세트 영구 ID 및 접근 URL 확보
    ```
    {
      "status": "success",
      "repository_id": "REPO-IL-2025-0225-003",
      "access_url": "https://item-repository.example.com/sets/REPO-IL-2025-0225-003",
      "timestamp": "2025-02-25T15:45:33Z"
    }
    ```

### 3. 슬랙 알림 전송

-   결정 에이전트가 슬랙 메시지 전송 API 호출
-   알림 요청 형태:
    ```
    POST /notifications/slack
    {
      "channel": "#item-generation-alerts",
      "title": "새로운 문항 세트 생성 완료",
      "message": "중학교 2학년 일차함수 평가 문항 세트가 생성되어 저장소에 저장되었습니다.",
      "details": {
        "item_set_id": "REPO-IL-2025-0225-003",
        "concept": "일차함수",
        "item_count": 5,
        "access_url": "https://item-repository.example.com/sets/REPO-IL-2025-0225-003"
      },
      "notification_level": "normal"
    }
    ```

### 4. 작업 완료 및 로그 기록

-   계획 에이전트에게 전체 프로세스 완료 통보
-   각 에이전트 단계별 로그 및 메타데이터 저장
-   시스템 성능 지표 업데이트

## 전체 문항 생성 워크플로우 요약

1. **초기 요청 접수**

    - 사용자가 문항 생성 요청
    - 계획 에이전트 활성화

2. **작업 계획 수립**

    - 계획 에이전트가 전체 작업 계획 수립
    - 필요 데이터 및 자원 식별

3. **데이터 수집**

    - 데이터 조회 에이전트가 내부 API 호출
    - 필요시 외부 검색 및 위키 자료 수집

4. **정보 통합**

    - 정보 통합 에이전트가 내외부 데이터 분석 및 통합
    - 문항 생성에 필요한 지식 체계 구성

5. **문항 설계**

    - 문항 설계 에이전트가 문항 구조 및 형태 설계
    - 평가 목표에 맞는 문항 템플릿 개발

6. **문항 생성**

    - 문항 생성 에이전트가 실제 문항 콘텐츠 작성
    - 정답 및 해설 개발

7. **문항 검증**

    - 검증 에이전트가 문항 품질 및 정확성 평가
    - 개선 필요 사항 식별

8. **문항 개선**

    - 개선 에이전트가 문항 수정 및 보완
    - 품질 향상 및 오류 수정

9. **최종 결정**

    - 결정 에이전트가 최종 문항 선정
    - 문항 세트 구성 및 최적화

10. **문항 저장**

    - 문항 저장 API 호출하여 저장소에 저장
    - 영구 ID 및 접근 URL 확보

11. **알림 전송**

    - 슬랙 채널에 완료 알림 메시지 전송
    - 문항 세트 접근 정보 공유

12. **작업 완료**
    - 전체 프로세스 완료 기록
    - 시스템 성능 지표 업데이트

이 통합된 워크플로우를 통해 지식맵 기반의 문항이 AI 에이전트들의 협력적 작업으로 생성되고, 저장소에 안전하게 보관되며, 관련 팀원들에게 슬랙을 통해 즉시 알림이 전달됩니다. 이로써 교육 콘텐츠 제작 과정이 자동화되면서도 품질 관리와 투명성이 보장됩니다.
